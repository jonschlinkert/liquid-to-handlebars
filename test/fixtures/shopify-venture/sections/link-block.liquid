<div class="page-width">
  <div class="flex flex--grid flex--no-gutter">
    {% assign image_size = '680x' %}
    {% case section.blocks.size %}
      {% when 1 %}
        {% assign flex_size = '' %}
        {% assign image_size = '1140x' %}
      {% when 2 %}
        {% assign flex_size = 'medium-up--one-half' %}
      {% when 3 %}
        {% assign flex_size = 'medium-up--one-third' %}
      {% else %}
        {% assign flex_size = 'medium-up--one-quarter' %}
    {% endcase %}
    {% for block in section.blocks %}
      <div class="flex__item flex {{ flex_size }}" {{ block.shopify_attributes }}>
        <noscript class="link-block-no-js">
          <a href="{{ block.settings.link }}" class="link-block" {% if block.settings.image != blank %}style="background-image: url({{ block.settings.image | img_url: image_size | format: 'jpg' }});"{% endif %}>
          {% if block.settings.image == blank %}
            {% capture current %}{% cycle 1, 2 %}{% endcapture %}
            <div class="placeholder-background">
              {{ 'lifestyle-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
            </div>
          {% endif %}
            <div class="flex flex--center-vertical">
              <div class="flex__item">
                <span class="emphasized-title h1 link-block__cta">
                  {{ block.settings.cta_label | escape }}
                </span>
              </div>
            </div>
          </a>
        </noscript>
          <a href="{{ block.settings.link }}" class="link-block lazyload"
           {% if block.settings.image != blank %}
              style="background-position: {{ block.settings.image_align }};
                     background-image: url('{{ block.settings.image | img_url: '300x300' }});"
            {% endif %}
            data-bgset="{% include 'bgset', image: block.settings.image %}"
            data-sizes="auto"
            data-parent-fit="cover">
          {% if block.settings.image == blank %}
            {% capture current %}{% cycle 1, 2 %}{% endcapture %}
            <div class="placeholder-background">
              {{ 'lifestyle-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
            </div>
          {% endif %}
          <div class="flex flex--center-vertical">
            <div class="flex__item">
              <span class="emphasized-title h1 link-block__cta">
                {{ block.settings.cta_label | escape }}
              </span>
            </div>
          </div>
        </a>
      </div>
    {% endfor %}
  </div>

  {% if section.blocks.size == 0 %}
    {% include 'no-blocks' %}
  {% endif %}
</div>

{% schema %}
  {
    "name": "Multiple link blocks",
    "class": "index-section",
    "max_blocks": 10,
    "blocks": [
      {
        "type": "link_block",
        "name": "Link block",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "url",
            "id": "link",
            "label": "Link"
          },
          {
            "type": "text",
            "id": "cta_label",
            "label": "Link label",
            "default": "Link label"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Multiple link blocks",
        "category": "Image",
        "blocks": [
          {
            "type": "link_block"
          },
          {
            "type": "link_block"
          }
        ]
      }
    ]
  }
{% endschema %}
